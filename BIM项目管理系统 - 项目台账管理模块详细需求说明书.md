# BIM项目管理系统 - 项目台账管理模块详细需求说明书

## 📋 版本更新记录

### v1.0.0 (2026-01-09)
**新增功能：统计数据动态响应筛选条件**

**需求背景**：
当用户通过"项目类型"等条件筛选项目时，顶部的统计看板（项目总数、合同总额等）需要相应更新，确保数据一致性。

**功能描述**：
- 统计看板根据当前筛选条件动态展示统计数据
- 确保统计看板数据与项目列表数据100%一致
- 支持所有筛选条件：项目类型、结算状态、逾期状态、搜索关键词

**技术实现**：
- 后端：扩展 `/api/projects/stats` 接口，支持筛选参数
- 前端：`fetchStats()` 函数传递当前筛选条件

**原型图**：
```
┌─────────────────────────────────────────────────────────────────┐
│  【顶部统计看板 - 根据筛选条件动态变化】                           │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌────────┐ │
│  │项目总数  │ │逾期项目  │ │总合同金额│ │已结算项目│ │平均进度│ │
│  │   20→2   │ │   3→0    │ │1500万→5亿│ │   15→1   │ │75%→80%│ │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘ └────────┘ │
│  ↑ 筛选前(全部)    ↑ 筛选后(仅BIM项目)                              │
│                                                                   │
│  【筛选控制区】                                                     │
│  [搜索框] [项目类型▼] [结算状态▼] [是否逾期▼] [+新增] [🔄刷新]  │
│                                                                   │
│  【数据一致性保证】                                                 │
│  统计看板数据 === 项目列表实际数据                                  │
│  项目总数(2) === 列表显示项目数(2) ✅                              │
│  总合同金额(500万) === 列表项目金额之和(500万) ✅                  │
└─────────────────────────────────────────────────────────────────┘
```

**测试验证**：
- [x] 初始加载：显示全局统计
- [x] 项目类型筛选：统计仅该类型项目
- [x] 组合筛选：统计同时满足所有条件的项目
- [x] 清空筛选：恢复全局统计
- [x] 数据一致性：统计数 === 列表数

---

# 一、模块概述

项目台账管理模块是BIM项目管理系统的核心基础模块，承担项目核心信息的集中管理、展示与快速检索功能。模块支持表格视图与卡片式视图一键切换，满足不同场景下的信息查看需求（表格视图侧重批量数据对比与高效筛选，卡片视图侧重项目信息可视化呈现与快速聚焦单个项目）。本模块为后续工作台、工作分解、周报管理等模块提供基础项目数据支撑，需保证数据的准确性、实时性与可追溯性。

# 二、核心功能需求

## 2.1 基础信息管理功能

核心需求：实现合同编号、合同名称、起止日期、合同金额、项目进度、项目负责人、结算情况、参与人员等基础信息的全生命周期管理，补充信息完整性与管理便捷性。

- 信息录入：支持单条项目信息手动录入、批量导入（支持Excel模板导入，需提供标准导入模板下载），录入时需进行字段校验（如合同编号唯一校验、日期逻辑校验：结束日期>开始日期、金额为正数校验等）。

- 信息编辑：支持单条项目信息编辑、批量编辑（支持选中多条项目统一修改相同字段，如统一修改项目负责人、调整项目起止日期等）。

- 信息查看：两种视图下均需完整展示核心字段，支持字段自定义显示（用户可根据需求勾选需展示的字段，隐藏无需显示的字段）。

- 信息删除：支持单条删除、批量删除，删除前需弹出二次确认弹窗（提示“删除后数据不可恢复，是否确认删除？”），并记录删除操作日志（含操作人、操作时间、删除项目名称）。

- 信息详情：支持点击项目信息（表格视图点击合同名称，卡片视图点击卡片主体）查看项目详情弹窗，详情页展示更完整的项目信息（补充核心需求外的扩展字段，如项目类型、所属部门、合同附件、项目备注等）。

## 2.2 视图切换功能

核心需求：实现表格视图与卡片式视图的流畅切换，切换后保留当前筛选条件与排序状态，保证用户操作连贯性。

- 切换入口：在模块顶部工具栏设置“视图切换”按钮组（表格图标+卡片图标），当前激活视图图标高亮显示（区分颜色+轻微放大效果），点击未激活视图图标即可完成切换，切换过程伴随平滑过渡动画（时长300ms）。

- 表格视图：支持分页显示（可自定义每页显示条数：10/20/50/100条）、表头排序（点击表头字段实现升序/降序排序，排序字段标注排序图标）、固定表头（滚动时表头保持不动，方便对照数据）。

- 卡片式视图：支持卡片hover放大效果（放大比例1.02）、卡片间距自适应屏幕尺寸、支持按行/按列排列（可自定义每行显示卡片数量：1/2/3/4张），卡片内部信息按“核心信息优先”原则分层展示。

## 2.3 筛选与检索功能

核心需求：支持多维度快速筛选与精准检索，帮助用户快速定位目标项目，提升数据查找效率。

- 精准检索：在顶部工具栏设置搜索框，支持按“合同编号、合同名称、项目负责人、参与人员”进行模糊搜索，输入关键词实时显示匹配结果（搜索延迟300ms，避免频繁触发搜索）。

- 高级筛选：点击“高级筛选”按钮弹出筛选弹窗，支持按以下条件组合筛选：
        

    - 时间维度：起止日期范围（可选择预设范围：近7天/近30天/本月/上月/本年/自定义范围）；

    - 金额维度：合同金额范围（输入最小金额/最大金额）；

    - 进度维度：项目进度范围（如0-20%/20%-50%/50%-80%/80%-100%）、是否逾期（起止日期对比当前日期，判断是否逾期）；

    - 结算维度：结算状态（未结算/结算中/已结算/部分结算）；

    - 人员维度：项目负责人（下拉选择）、参与人员（下拉选择）、所属部门（下拉选择）。

- 筛选记忆：系统自动记忆用户上次使用的筛选条件（有效期为当前登录会话），再次进入模块时自动加载筛选条件与筛选结果。

## 2.4 数据统计与可视化功能

核心需求：提供基础数据统计功能，帮助用户快速掌握项目整体情况，辅助决策分析。

- 顶部统计看板：在模块顶部设置统计看板（固定显示，不随滚动隐藏），展示核心统计数据：
        

    - 项目总数：当前系统内所有项目数量；

    - 逾期项目数：起止日期已过但未完成的项目数量（标注红色提醒）；

    - 总合同金额：所有项目合同金额总和；

    - 已结算项目数/占比：已完成结算的项目数量及占项目总数的比例；

    - 平均项目进度：所有项目进度的平均值（百分比展示）。

- 进度可视化：表格视图中用“进度条”直观展示项目进度（进度条颜色随进度变化：0-30%红色/30%-70%黄色/70%-100%绿色）；卡片视图中进度条置于卡片顶部，占据卡片宽度的80%，视觉更醒目。

## 2.5 权限管理功能

核心需求：基于角色的权限控制，确保不同用户对项目信息的操作权限符合业务规范，保障数据安全。

- 角色划分：
        

    - 管理员：拥有模块全部操作权限（录入/编辑/删除/筛选/导出/权限配置）；

    - 部门负责人：拥有本部门项目的查看、筛选、导出权限，可编辑本部门项目的部分字段（如项目进度、结算情况）；

    - 项目负责人：拥有自己负责项目的查看、编辑权限（可编辑项目进度、参与人员、备注等字段），无删除权限；

    - 普通员工：仅拥有项目查看权限（仅可查看自己参与的项目或部门公开项目），无编辑/删除权限。

- 权限控制：系统根据用户角色自动分配操作权限，无权限操作的按钮灰化显示并添加悬浮提示（“您无此操作权限，请联系管理员”）。

## 2.6 数据导出与打印功能

核心需求：支持项目数据导出与打印，满足线下汇报、存档等需求。

- 数据导出：支持导出当前筛选结果的全部数据，导出格式支持Excel/PDF两种，导出文件命名规则：“项目台账_导出时间_操作人.xlsx/pdf”（如“项目台账_20260109_张三.xlsx”）。

- 打印功能：支持打印当前视图的项目数据，打印前可预览打印效果，支持自定义打印设置（如是否打印表头、是否打印统计看板、纸张大小、方向等）。

# 三、UI设计需求（核心：极简高级感+专业科技感+系统级布局规范）

## 3.1 设计风格定位

整体风格：极简主义+专业科技感，贴合BIM系统的工程属性与专业定位，同时保证视觉美感与操作舒适性。色调以“深空蓝”为主色调（代表专业、可靠），搭配“浅灰”“白色”为中性色，辅以“绿色（进度正常）”“黄色（进度预警）”“红色（逾期/异常）”为功能警示色，色彩饱和度控制在70%-80%，避免视觉疲劳。布局遵循系统级规范，采用“侧导航栏+顶部导航+内容区域+背景层”结构，契合尼尔森F型视觉模型，引导用户自然浏览核心信息，提升操作效率。

## 3.2 系统级页面布局设计（契合尼尔森F型视觉模型）

- 

- 

    - 

- 背景层：全局背景采用浅灰色（#f5f7fa），避免纯白背景的刺眼感，同时为前景内容（侧导航、卡片、表格等）提供清晰视觉分层，提升页面呼吸感。

- 侧导航栏（F型视觉左侧纵向区域）：
布局位置：页面左侧固定显示，宽度220px，高度100%（与浏览器窗口高度一致），背景色为纯白色，边框右侧设置1px浅灰色分隔线（#e0e0e0），增强与其他区域的边界感。

- 内容构成：顶部放置系统Logo+系统名称“BIM项目管理系统”（Logo在上，名称在下，名称字号16px，加粗）；下方为系统全模块导航菜单，包含“项目台账管理”“工作台”“工作分解”“周报管理”等模块选项，当前激活模块（项目台账管理）用主题色（深空蓝）标注左侧竖线+文字变色，未激活模块为灰色文字；底部放置用户信息入口（头像+用户名，hover展开个人中心菜单：密码修改、退出登录等）。

- 交互细节：支持折叠/展开功能，点击折叠按钮后宽度收缩至60px（仅显示模块图标），再次点击展开；导航菜单hover时背景色变为浅灰色（#f8f9fa），提升交互感知。

- 顶部导航（F型视觉顶部横向区域）：
布局位置：侧导航栏右侧，宽度=浏览器窗口宽度-侧导航栏宽度，高度60px，背景色为纯白色，边框底部设置1px浅灰色分隔线（#e0e0e0），固定显示（滚动时不跟随滚动）。

- 内容构成：左侧为当前模块定位面包屑导航（如“首页>项目管理>项目台账管理”），字号14px，灰色文字，帮助用户明确当前所处位置；中间区域预留系统级功能入口（如消息通知、系统设置，图标化显示，hover显示红点/数字提醒）；右侧为功能按钮组（视图切换、高级筛选、导出、打印、新增项目），按钮采用扁平化设计，hover时轻微变色+阴影效果（阴影：0 2px 8px rgba(0,0,0,0.1)），其中“新增项目”按钮采用主题色背景+白色文字，突出重要操作。

- 内容区域（F型视觉核心浏览区域）：
布局位置：顶部导航下方，宽度=浏览器窗口宽度-侧导航栏宽度，高度=浏览器窗口高度-顶部导航高度，背景色继承全局背景（#f5f7fa），支持滚动。

- 内部分区：
搜索与统计区（F型视觉首屏顶部，优先浏览区域）：顶部左侧放置搜索框（宽度300px，圆角8px，默认显示占位提示“搜索合同编号/名称/负责人...”，聚焦时边框变色为主题色）；右侧为统计看板（采用卡片式布局，3-5个统计项横向排列，超出部分自适应换行），每个统计项为独立卡片（圆角12px，轻微阴影），卡片内部上下排列“统计名称（字号14px，灰色）”与“统计数值（字号20px，加粗）”，逾期项目数卡片边框标注红色，其他卡片边框为中性灰，卡片间距20px，卡片内边距16px。

- 视图内容区（F型视觉核心信息区）：搜索与统计区下方，占内容区域主要面积，两种视图切换时保持该区域布局稳定，仅替换内部内容展示形式：
表格视图：采用无边框设计，行间距16px，表头背景色为浅灰色（#f8f9fa），表头字体加粗（14px），数据行字体13px，奇偶行无背景色区分（避免视觉杂乱），hover行时背景色为极浅的主题色（#eef5ff），进度条采用圆角设计（高度6px），表格内操作按钮（编辑/删除/查看详情）默认隐藏，hover行时显示，按钮图标化（避免文字占用空间）；表格外框与内容区域边界保留24px内边距，提升呼吸感。

- 卡片视图：严格区分行列槽宽度，采用“均匀分布+固定槽宽”设计，确保布局整齐美观：
行槽宽度：纵向间距（行与行之间的距离）固定为32px，保证纵向呼吸感，避免卡片拥挤；

- 列槽宽度：横向间距（列与列之间的距离）固定为24px，同时支持自定义每行显示卡片数量（1/2/3/4张），不同数量下卡片宽度自适应调整（如每行3张时，卡片宽度=（内容区域宽度-24px×2-24px×2）/3，其中两侧24px为内容区域内边距）；

- 卡片样式：卡片采用圆角16px，轻微阴影（0 4px 12px rgba(0,0,0,0.08)），背景色为白色，内部内边距20px，信息分层：顶部为进度条（高度8px，圆角4px）+ 合同名称（字号16px，加粗，margin-top 12px）+ 合同编号（字号12px，灰色，margin-top 4px）；中间为核心信息网格布局（2列），每行列“字段名称（灰色，12px）+ 字段值（13px）”，包含起止日期、合同金额、项目负责人、结算情况；底部为参与人员（最多显示3个头像，超出部分显示“+N”）+ 操作按钮组（编辑/查看详情，图标化，置于卡片右下角）。

- 分页控件区：内容区域底部居中显示，包含页码切换、每页条数选择、当前数据量提示（“共X条，当前第X页”），分页按钮采用扁平化设计，当前页码高亮显示（主题色背景+白色文字）；分页控件与视图内容区保留24px间距。

## 3.3 交互细节设计

- hover效果：所有可点击元素（按钮、链接、卡片、表格行）hover时均有明显反馈（颜色变化、阴影加深、轻微放大），提升交互感知度。

- 侧导航栏交互原型：
  折叠/展开交互：侧导航栏顶部Logo右侧设置“折叠/展开”按钮（图标为“←”/“→”，根据当前状态切换），点击按钮后触发平滑过渡动画（时长300ms），折叠时宽度从220px收缩至60px（仅保留模块图标，隐藏文字），展开时从60px恢复至220px（显示图标+文字）；折叠状态下，hover模块图标时弹出悬浮提示框（显示模块名称，背景色为白色，边框阴影，停留时间≥1秒后消失）。

- 模块切换交互：点击导航菜单中的模块选项（如“工作台”“工作分解”），当前激活模块（原“项目台账管理”）的主题色左侧竖线+文字变色效果取消，新选中模块添加该激活效果，同时页面内容区域平滑切换至对应模块页面（过渡动画时长300ms，避免页面跳转生硬）；点击当前已激活模块，无状态变化，不触发页面刷新。

- 用户信息交互：hover底部用户信息入口（头像+用户名）时，下拉展开个人中心菜单（菜单宽度与侧导航栏一致，背景色白色，边框阴影），菜单选项包含“个人资料”“密码修改”“系统设置”“退出登录”，hover菜单选项时背景色变为浅灰色（#f8f9fa）；点击菜单选项触发对应功能，点击菜单外区域或再次hover用户信息入口，菜单收起（收起无动画，即时生效）。

- 顶部导航交互原型：
  面包屑导航交互：面包屑导航中除当前模块名称外，其他层级（如“首页”“项目管理”）均为可点击链接，点击后跳转至对应层级页面，跳转时页面内容区域平滑过渡（时长300ms）；当前模块名称为灰色不可点击状态，明确用户当前定位。

- 系统级功能入口交互：消息通知图标hover时，右上角显示未读消息数量红点（如“3”），点击图标下拉展开消息列表（背景色白色，边框阴影，最大高度300px，超出部分可滚动），消息列表项hover时背景色变为浅灰色；点击消息项跳转至对应消息详情页，点击“标记已读”“全部已读”按钮可批量处理消息；系统设置图标hover时显示“系统设置”悬浮提示，点击后跳转至系统设置页面（新页面打开，保留当前项目台账页面会话）。

- 功能按钮组交互：视图切换按钮组点击时，当前激活视图图标高亮（主题色填充+轻微放大1.1倍），未激活视图图标为灰色，切换过程中内容区域视图同步平滑过渡（时长300ms）；高级筛选、导出、打印按钮点击时触发对应弹窗/功能（高级筛选弹出筛选弹窗，导出弹出格式选择下拉框，打印弹出打印预览页面）；新增项目按钮点击时弹出项目录入表单弹窗，弹窗弹出时伴随淡入动画（时长200ms），聚焦表单第一个必填字段（合同编号）。

- 加载状态：数据加载时显示骨架屏（表格视图显示表头+行骨架，卡片视图显示卡片骨架），替代传统加载动画，提升视觉体验。

- 弹窗设计：编辑、查看详情、高级筛选等弹窗采用居中显示，弹窗背景添加半透明遮罩（rgba(0,0,0,0.5)），弹窗内部采用“标题+内容+操作按钮”布局，操作按钮（确认/取消）置于弹窗底部右侧，弹窗圆角12px，轻微阴影。

- 错误提示：字段校验错误、操作失败等提示采用“红色文字+图标”形式，置于错误字段下方（表单场景）或顶部浮动弹窗（全局操作场景），浮动弹窗3秒后自动消失，支持手动关闭。

- 响应式设计：支持PC端不同屏幕尺寸（最小宽度1280px），平板端（768px-1279px）自动调整卡片数量、表格字段显示，移动端（<768px）隐藏统计看板，表格视图支持横向滚动，保证在不同设备上均能正常使用。

## 3.4 图标与字体设计

- 图标：采用线性图标（线条粗细2px），风格统一，所有图标颜色与当前场景文字颜色一致（默认灰色，强调时用主题色），避免图标杂乱。

- 字体：全局采用无衬线字体（如微软雅黑、思源黑体），字体层级清晰：模块标题（18px，加粗）、弹窗标题（16px，加粗）、统计数值（20px，加粗）、字段值（13px）、字段名称/提示文字（12px，灰色），保证可读性。

# 四、数据规范需求

- 字段格式：
        

    - 合同编号：采用“部门缩写-年份-序号”格式（如“XM-2026-001”），系统自动生成建议编号，支持手动修改；

    - 起止日期：格式为“YYYY-MM-DD”，支持日期选择器选择，避免手动输入错误；

    - 合同金额：保留2位小数，单位为“万元”，显示时添加千位分隔符（如12,345.67万元）；

    - 项目进度：百分比格式（0%-100%），支持手动输入或拖动进度条调整；

    - 结算情况：枚举值（未结算/结算中/已结算/部分结算），下拉选择；

    - 参与人员：支持多选，关联系统用户列表，选择后显示用户头像+姓名。

- 数据校验：
        

    - 必填字段：合同编号、合同名称、起止日期、合同金额、项目负责人为必填字段，未填写时无法提交；

    - 唯一性校验：合同编号唯一，重复录入时提示“该合同编号已存在，请重新输入”；

    - 逻辑校验：结束日期必须大于开始日期，否则提示“结束日期不能早于开始日期”；合同金额必须为正数，否则提示“合同金额不能为负数”；项目进度必须在0%-100%之间，否则提示“进度范围为0%-100%”。

- 数据备份：系统自动备份项目台账数据（每日凌晨备份一次），支持手动备份，备份数据保留3个月，支持数据恢复（从备份文件恢复）。

# 五、与后续模块的衔接预留

为保证后续模块（工作台、工作分解、周报管理）顺利对接，本模块需预留以下衔接点：

- 数据接口：提供项目基础信息查询接口（支持按项目ID、项目负责人、部门等条件查询），供后续模块调用；

- 字段预留：在项目详情中预留“关联工作台任务”“关联工作分解结构（WBS）”“关联周报记录”字段，后续模块开发完成后可直接关联；

- 操作入口：在卡片视图与表格视图的操作按钮组中预留“进入工作台”“查看工作分解”“查看周报”按钮位置，后续模块上线后直接启用，无需调整界面布局。

# 六、非功能需求

- 性能需求：单页加载100条项目数据时，加载时间≤1.5秒；筛选、排序操作响应时间≤500ms；批量导入1000条数据时，处理时间≤10秒。

- 稳定性需求：系统连续运行24小时无异常，无数据丢失、界面卡顿等问题；支持同时10个用户并发操作，性能无明显下降。

- 兼容性需求：支持主流浏览器（Chrome 90+、Edge 90+、Firefox 88+、Safari 14+），界面显示正常，功能正常使用。

- 可维护性需求：代码模块化设计，预留扩展接口，后续新增功能（如项目归档、数据权限细化）时可快速开发，不影响现有功能。
> （注：文档部分内容可能由 AI 生成）