# 项目台账管理 UI 优化方案

## 📋 需求概述

根据《台账管理.MD》文档和参考设计，对项目台账管理页面进行全面UI优化，提升视觉层次、数据可视化和用户体验。

---

## 🎯 核心优化目标

### 1. 顶部统计卡片优化
- ✅ 主次分明：突出"总合同金额"核心指标
- ✅ 警示强化：逾期卡片增加视觉冲击力
- ✅ 数据可视化：增加进度环、柱状图等可视化元素

### 2. 表格区域优化
- ✅ 增加行高至 56-64px，提升呼吸感
- ✅ 状态标签改用胶囊式设计 + 饱和度更高的配色
- ✅ 进度条增加百分比数字 + 渐变色填充
- ✅ 鼠标悬停行增加浅色背景高亮
- ✅ 操作列改为图标按钮组

### 3. 配色体系重构
- ✅ 建立统一的设计规范
- ✅ 优化色彩对比度和视觉层次

---

## 🎨 ASCII 原型图

### 整体布局原型

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│  BIM项目管理系统                                                                          │
├──────────┬────────────────────────────────────────────────────────────────────────────┤
│          │  🏠 工作台  📊 项目台账管理  🔗 工作分解结构  📄 合同与结算  👥 人员管理    │
│  侧边栏  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━      │
│  导航    │                                                                              │
│          │  ┌──────────────┬──────────────┬──────────────┬─────────────────┐          │
│          │  │ 📁 项目总数   │ ⚠️ 逾期项目   │ 💰 总合同金额 │ 📊 平均进度      │          │
│          │  │              │              │              │                 │          │
│          │  │     12       │      2       │ 2,226.60万   │      61%        │          │
│          │  │  本月新增+2   │  需立即处理   │  回款率45%    │  整体进度正常    │          │
│          │  │     ⭕83%    │     ◕17%     │  ▃▄▆█        │     ⭕61%       │          │
│          │  └──────────────┴──────────────┴──────────────┴─────────────────┘          │
│          │                                                                              │
│          │  ┌─────────────────────────────────────────────────────────────────┐        │
│          │  │ 🔍 搜索合同编号、项目名称...         [状态筛选▼] [时间范围▼] [🔄] │        │
│          │  └─────────────────────────────────────────────────────────────────┘        │
│          │                                                                              │
│          │  ┌──────────────────────────────────────────────────────────────────────┐  │
│          │  │ 项目信息           │起止日期       │进度  │负责人│结算状态    │操作  │  │
│          │  ├──────────────────────────────────────────────────────────────────────┤  │
│          │  │ 📋 XX大厦BIM全过程  │2026-01-01   │█████│ 👤   │✅ 已结算  │👁✎⋮  │  │
│          │  │    HT2026-001      │至2026-12-31  │100% │ 王工  │           │      │  │
│          │  ├──────────────────────────────────────────────────────────────────────┤  │
│          │  │ 📋 某某住宅项目      │2026-03-15   │██   │ 👤   │⚠️ 未结算  │👁✎⋮  │  │
│          │  │    HT2026-002      │至2026-09-15  │ 5%  │ 李工  │           │      │  │
│          │  ├──────────────────────────────────────────────────────────────────────┤  │
│          │  │ 📋 商业综合体设计    │2026-02-01   │████▌│ 👤   │🟡 部分结算│👁✎⋮  │  │
│          │  │    HT2026-003      │至2026-11-30  │ 65% │ 张工  │           │      │  │
│          │  ├──────────────────────────────────────────────────────────────────────┤  │
│          │  │ 📋 市政道路工程      │2026-04-01   │████▌│ 👤   │❌ 未结算  │👁✎⋮  │  │
│          │  │    HT2026-004      │至2027-03-31  │ 45% │ 刘工  │           │      │  │
│          │  └──────────────────────────────────────────────────────────────────────┘  │
│          │                                                                              │
│          │  ◀ 1 2 3 4 5 ▶  共 45 条    每页 [20] 条                                  │
│          │                                                                              │
└──────────┴──────────────────────────────────────────────────────────────────────────────┘
```

### 统计卡片详细设计

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          顶部数据统计卡片区域                                  │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐
│  📁 项目总数     │  │ ⚠️ 逾期项目      │  │ 💰 总合同金额    │  │ 📊 平均进度      │
│                 │  │                 │  │                 │  │                 │
│      12         │  │      2          │  │  2,226.60万     │  │      61%        │
│  本月新增 +2     │  │  需立即处理      │  │   回款率 45%     │  │ 整体进度正常     │
│                 │  │                 │  │                 │  │                 │
│     ⭕          │  │     ◕           │  │  ▃▄▆█ ▃▄       │  │     ⭕          │
│    83%         │  │    17%          │  │  已回 待回       │  │    61%         │
│   ╱────╲       │  │   ╱────╲        │  │                 │  │   ╱────╲       │
│  │ 83% │       │  │  │ 17% │        │  │  ████░░░░       │  │  │ 61% │       │
│   ╲────╱       │  │   ╲────╱        │  │  1002 1224      │  │   ╲────╱       │
│                 │  │                 │  │                 │  │                 │
│  背景: #FFFFFF  │  │  背景: #FFF8E1  │  │  背景: #E3F2FD  │  │  背景: #F3E5F5  │
│  进度环: 蓝绿   │  │  进度环: 橙色   │  │  柱状图: 渐变   │  │  进度环: 紫色   │
└─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘
      卡片1                卡片2                卡片3                卡片4

尺寸规范：
- 卡片宽度: calc(25% - 12px)  (4列均分，间距16px)
- 卡片高度: 140px
- 圆角: 12px
- 间距: 左右16px，上下16px
- 内边距: 20px

字体规范：
- 核心数值: 32px, 粗体, 颜色根据状态
- 标签文字: 14px, 中等, #666666
- 辅助信息: 12px, 常规, #999999
```

### 表格行详细设计

```
┌──────────────────────────────────────────────────────────────────────────────┐
│ 表头行 (高度: 48px, 背景: #F7F8FA)                                            │
├──────────────────────────────────────────────────────────────────────────────┤
│ 项目信息              │起止日期            │进度   │负责人  │结算状态    │操作 │
│ (宽度: 220px)         │(宽度: 150px)       │(120px)│(100px) │(120px)     │100px│
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│ 普通行 (高度: 64px, hover背景: #F7F8FA)                                       │
├──────────────────────────────────────────────────────────────────────────────┤
│ 📋 XX大厦BIM全过程咨询  │2026-01-01 至 2026-12-31│██████████│ 👤    │✅ 已结算  │👁 ✎ ⋮│
│ HT2026-001            │                    │  100%   │ 王工   │          │      │
│                      │                    │(绿色)   │(蓝色)  │(绿色胶囊)│     │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│ 警告行 (高度: 64px, 背景: #FEF2F2)                                            │
├──────────────────────────────────────────────────────────────────────────────┤
│ 📋 某某住宅项目        │2026-03-15 至 2026-09-15│██      │ 👤    │❌ 未结算  │👁 ✎ ⋮│
│ HT2026-002            │                    │   5%   │ 李工   │          │      │
│ ⚠️ 已逾期             │                    │(橙色)  │(橙色)  │(红色胶囊)│     │
└──────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│ 进行中行 (高度: 64px)                                                        │
├──────────────────────────────────────────────────────────────────────────────┤
│ 📋 商业综合体设计      │2026-02-01 至 2026-11-30│██████░  │ 👤    │🟡 部分结算│👁 ✎ ⋮│
│ HT2026-003            │                    │  65%   │ 张工   │          │      │
│                      │                    │(蓝色)  │(蓝色)  │(黄色胶囊)│     │
└──────────────────────────────────────────────────────────────────────────────┘

进度条样式：
- 高度: 8px
- 圆角: 4px
- 背景: #E5E7EB
- 填充: 渐变色 (根据进度)
  - 0-30%: #EF4444 → #F87171 (红色)
  - 30-70%: #3B82F6 → #60A5FA (蓝色)
  - 70-100%: #10B981 → #34D399 (绿色)
- 百分比文字: 12px, 右对齐, 进度条右侧

状态标签样式：
- 胶囊式设计
- 高度: 28px
- 内边距: 4px 12px
- 圆角: 14px
- 字体: 13px, 中等
- 已结算: 背景 #10B981, 文字 #FFFFFF
- 未结算: 背景 #EF4444, 文字 #FFFFFF
- 部分结算: 背景 #F59E0B, 文字 #FFFFFF

负责人头像：
- 尺寸: 32px × 32px
- 圆形
- 背景色与进度条颜色一致
- 文字: 12px, 白色, 居中
- 姓名显示在头像下方或右侧: 13px, 中等, #374151
```

### 搜索筛选区域设计

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 🔍 搜索合同编号、项目名称、负责人...                    [状态筛选▼] [时间范围▼] │
│ ─────────────────────────────────────────────────────────────────────────   │
│ 宽度: 400px                     下拉框: 宽度 120px, 高度 36px               │
│ 高度: 40px                     按钮间距: 8px                                │
│ 边框: 1px solid #D1D5DB        图标: 🔽 📅                                 │
│ 圆角: 6px                      hover: 背景 #F3F4F6                          │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 配色方案规范

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          配色体系重构                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  主色调:                                                                      │
│  ├─ 主色: #1890FF → #2F54EB (更沉稳的蓝色)                                   │
│  ├─ 成功/已完成: #52C41A → #10B981 (更清新的绿色)                            │
│  ├─ 警示/逾期: 新增 #FA8C16 标准警示色                                       │
│  ├─ 危险/未结算: #FF4D4F 保持                                                │
│  └─ 中性背景: #F5F5F5 → #F7F8FA (更柔和)                                     │
│                                                                              │
│  卡片背景色:                                                                  │
│  ├─ 项目总数: #FFFFFF (白色)                                                 │
│  ├─ 逾期项目: #FFF8E1 (淡黄色 - 警示)                                        │
│  ├─ 总合同金额: #E3F2FD (淡蓝色 - 数据)                                       │
│  └─ 平均进度: #F3E5F5 (淡紫色 - 状态)                                        │
│                                                                              │
│  进度条渐变色:                                                                │
│  ├─ 0-30%: linear-gradient(90deg, #EF4444, #F87171)  (红色)                 │
│  ├─ 30-70%: linear-gradient(90deg, #3B82F6, #60A5FA) (蓝色)                 │
│  └─ 70-100%: linear-gradient(90deg, #10B981, #34D399) (绿色)                │
│                                                                              │
│  文字颜色:                                                                    │
│  ├─ 标题: #1F2937 (深灰)                                                     │
│  ├─ 正文: #374151 (中灰)                                                     │
│  ├─ 辅助: #6B7280 (浅灰)                                                     │
│  └─ 禁用: #9CA3AF (极浅灰)                                                   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 尺寸规范总结

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          设计规范                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  间距规范:                                                                    │
│  ├─ 页面边距: 24px                                                           │
│  ├─ 卡片间距: 16px                                                           │
│  ├─ 表格行高: 64px                                                           │
│  ├─ 按钮圆角: 6px (小按钮) / 8px (大按钮)                                    │
│  ├─ 卡片圆角: 12px                                                           │
│  └─ 阴影: 0 2px 8px rgba(0,0,0,0.08)                                         │
│                                                                              │
│  字体规范:                                                                    │
│  ├─ 核心数值: 32px, 粗体                                                     │
│  ├─ 卡片标题: 14px, 中等                                                     │
│  ├─ 表头: 14px, 中等                                                         │
│  ├─ 表格内容: 13px, 常规                                                     │
│  └─ 辅助信息: 12px, 常规                                                     │
│                                                                              │
│  图标尺寸:                                                                    │
│  ├─ 大图标: 32px × 32px                                                      │
│  ├─ 中图标: 20px × 20px                                                      │
│  └─ 小图标: 16px × 16px                                                      │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 🔧 技术实现方案

### 文件修改清单

```
d:\project\BIM PMS\frontend\src\pages\
├── ProjectLedger.tsx        ← 主组件文件 (修改)
└── ProjectLedger.css        ← 样式文件 (重构)
```

### 实现步骤

#### 阶段1: 统计卡片优化

**新增组件**: `StatCard` - 统计卡片组件
- 支持不同配色方案 (白色/淡黄/淡蓝/淡紫)
- 支持可视化元素 (进度环/半圆环/柱状图)
- 响应式布局

**技术要点**:
1. 使用 SVG 绘制进度环
2. 使用 CSS 渐变实现柱状图
3. 使用 CSS 变量管理配色

#### 阶段2: 表格优化

**修改内容**:
1. 表格行高: `rowClassName` + 自定义CSS
2. 状态标签: 自定义 `renderSettlementStatus` 函数
3. 进度条: 自定义 `renderProgress` 函数
4. 操作按钮: 图标按钮组

**技术要点**:
1. 使用 Ant Design Table 的 `rowClassName` 实现行样式
2. 使用 CSS 实现胶囊式标签
3. 使用 CSS 渐变实现进度条

#### 阶段3: 样式重构

**CSS 架构**:
```css
/* CSS 变量定义 */
:root {
  --color-primary: #2F54EB;
  --color-success: #10B981;
  --color-warning: #FA8C16;
  --color-danger: #EF4444;
  --color-bg-base: #F7F8FA;
  /* ... */
}

/* 统计卡片样式 */
.stat-card { ... }
.stat-card--warning { ... }
.stat-card--info { ... }
.stat-card--purple { ... }

/* 表格样式 */
.custom-table { ... }
.custom-table-row { ... }
.custom-table-row--hover { ... }

/* 标签样式 */
.status-tag { ... }
.status-tag--success { ... }
.status-tag--warning { ... }
.status-tag--danger { ... }
```

---

## 📊 组件结构设计

```
ProjectLedger
├── StatsCards (新增)
│   ├── StatCard (新增)
│   │   ├── ProgressRing (新增 - 可视化组件)
│   │   ├── SemiCircle (新增)
│   │   └── BarChart (新增)
│   ├── StatCard
│   └── ...
├── SearchBar (保持)
├── ProjectTable (优化)
│   ├── columns.render (优化 - 进度条)
│   ├── columns.render (优化 - 状态标签)
│   └── columns.render (优化 - 操作按钮)
└── Modals (保持)
```

---

## ✅ 验收标准

### 视觉验收
- [ ] 统计卡片具有4种不同配色背景
- [ ] 进度环/半圆环/柱状图正确显示
- [ ] 表格行高为 64px，呼吸感良好
- [ ] 状态标签为胶囊式，颜色饱和度高
- [ ] 进度条带百分比数字和渐变色
- [ ] 鼠标悬停行有浅色背景高亮
- [ ] 操作按钮为图标按钮组

### 功能验收
- [ ] 数据正确显示
- [ ] 交互功能正常 (搜索、筛选、排序)
- [ ] 弹窗功能正常
- [ ] 响应式布局正常

### 性能验收
- [ ] 无明显性能问题
- [ ] 大数据量时表格流畅

---

## 🚀 实施计划

1. **准备阶段** (0.5天)
   - 创建 CSS 变量定义
   - 创建可视化组件

2. **实施阶段** (2天)
   - 优化统计卡片
   - 优化表格区域
   - 调整配色和间距

3. **测试阶段** (0.5天)
   - 视觉测试
   - 功能测试
   - 兼容性测试

---

## 📝 注意事项

1. **不影响其他模块**
   - 只修改 `ProjectLedger.tsx` 和 `ProjectLedger.css`
   - 不修改共享组件
   - 不修改全局样式

2. **保持数据一致性**
   - 保持 API 调用不变
   - 保持数据处理逻辑不变
   - 只修改 UI 层

3. **可维护性**
   - 使用 CSS 变量
   - 组件化设计
   - 代码注释清晰
